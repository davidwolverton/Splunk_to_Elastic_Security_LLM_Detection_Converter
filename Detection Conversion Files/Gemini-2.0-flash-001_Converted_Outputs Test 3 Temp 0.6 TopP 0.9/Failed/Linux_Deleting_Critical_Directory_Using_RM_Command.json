{
  "actions": [],
  "alias_purpose": "detection_rule",
  "author": [
    "Google Gemini 2.0 Flash 001",
    "Teoderick Contreras, Splunk"
  ],
  "building_block_type": "default",
  "description": "Google Gemini 2.0 Flash 001: The following analytic detects the deletion of critical directories on a Linux machine using the `rm` command with argument rf. It leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line executions targeting directories like /boot, /var/log, /etc, and /dev. This activity is significant because deleting these directories can severely disrupt system operations and is often associated with destructive campaigns like Industroyer2. If confirmed malicious, this action could lead to system instability, data loss, and potential downtime, making it crucial for immediate investigation and response.  Note: Rule converted with Google Gemini 2.0 Flash 001",
  "enabled": true,
  "false_positives": [
    "Administrator or network operator can use this application for automation purposes. Please update the filter macros to remove false positives."
  ],
  "from": "now-60m",
  "interval": "1m",
  "investigation_fields": {
    "field_names": []
  },
  "license": "Elastic License v2",
  "max_signals": 100,
  "meta": {
    "version": 1
  },
  "name": "Google Gemini 2.0 Flash 001: Linux Deleting Critical Directory Using RM Command",
  "note": "Investigate any instances of rm -rf being used on critical directories.",
  "outcome": "unknown",
  "output_index": ".siem-signals-default",
  "references": [
    "https://www.welivesecurity.com/2022/04/12/industroyer2-industroyer-reloaded/",
    "https://cert.gov.ua/article/39518"
  ],
  "risk_score": 64,
  "rule_id": "linux_deleting_critical_directory_using_rm_command",
  "severity": "high",
  "tags": [
    "Google Gemini 2.0 Flash 001",
    "analytic_story:AwfulShred",
    "analytic_story:Data Destruction",
    "analytic_story:Industroyer2",
    "asset_type:Endpoint",
    "mitre_attack_id:T1485",
    "product:Splunk Enterprise",
    "product:Splunk Enterprise Security",
    "product:Splunk Cloud",
    "security_domain:endpoint"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0040",
        "name": "Impact",
        "reference": "https://attack.mitre.org/tactics/TA0040/"
      },
      "technique": [
        {
          "id": "T1485",
          "name": "Data Destruction",
          "reference": "https://attack.mitre.org/techniques/T1485/"
        }
      ]
    }
  ],
  "throttle": "no_actions",
  "type": "eql",
  "version": 1,
  "language": "eql",
  "query": """sequence by process.entity_id
  [process where event.type == "start" and process.name == "rm" and process.args like "*-rf*" and
   (process.args like "*/boot/*" or process.args like "*/var/log/*" or process.args like "*/etc/*" or process.args like "*/dev/*")]
  [file where event.type == "deletion" and
   (file.path like "*/boot/*" or file.path like "*/var/log/*" or file.path like "*/etc/*" or file.path like "*/dev/*")]""",
  "index": [
    "logs-endpoint.events.*"
  ],
  "data_view_id": "global"
}