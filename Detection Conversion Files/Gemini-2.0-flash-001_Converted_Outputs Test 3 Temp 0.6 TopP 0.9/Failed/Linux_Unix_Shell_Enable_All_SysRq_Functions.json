{
  "actions": [],
  "alias_purpose": null,
  "alias_target_id": null,
  "author": [
    "Teoderick Contreras, Splunk",
    "Google Gemini 2.0 Flash 001"
  ],
  "building_block_type": null,
  "description": "Google Gemini 2.0 Flash 001: The following analytic detects the execution of a command to enable all SysRq functions on a Linux system, a technique associated with the AwfulShred malware. It leverages Endpoint Detection and Response (EDR) data to identify processes executing the command to pipe bitmask '1' to /proc/sys/kernel/sysrq. This activity is significant as it can indicate an attempt to manipulate kernel system requests, which is uncommon and potentially malicious. If confirmed, this could allow an attacker to reboot the system or perform other critical actions, leading to system instability or further compromise.",
  "enabled": true,
  "exceptions_list": [],
  "false_positives": [
    "unknown"
  ],
  "from": "now-60m",
  "interval": "5m",
  "investigation_fields": {
    "field_names": []
  },
  "license": null,
  "max_signals": 100,
  "meta": {
    "version": 1
  },
  "name": "Google Gemini 2.0 Flash 001: Linux Unix Shell Enable All SysRq Functions",
  "namespace": "default",
  "note": "Google Gemini 2.0 Flash 001: This rule was converted from Splunk SPL to Elastic EQL.",
  "outcome": null,
  "output_index": ".siem-signals-default",
  "references": [
    "https://www.kernel.org/doc/html/latest/admin-guide/sysrq.html",
    "https://cert.gov.ua/article/3718487",
    "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/overview-of-the-cyber-weapons-used-in-the-ukraine-russia-war/"
  ],
  "related_integrations": [],
  "required_fields": [
    {
      "name": "process.name",
      "type": "string"
    },
    {
      "name": "process.command_line",
      "type": "string"
    },
    {
      "name": "host.hostname",
      "type": "string"
    },
    {
      "name": "user.name",
      "type": "string"
    },
    {
      "name": "process.parent.name",
      "type": "string"
    },
    {
      "name": "process.pid",
      "type": "long"
    },
    {
      "name": "process.parent.pid",
      "type": "long"
    },
    {
      "name": "process.entity_id",
      "type": "string"
    }
  ],
  "response_actions": [],
  "risk_score": 36,
  "risk_score_mapping": [],
  "rule_id": "linux_unix_shell_enable_all_sysrq_functions",
  "rule_name_override": null,
  "setup": null,
  "severity": "medium",
  "severity_mapping": [],
  "tags": [
    "Google Gemini 2.0 Flash 001",
    "analytic_story:AwfulShred",
    "analytic_story:Data Destruction",
    "asset_type:Endpoint",
    "mitre_attack_id:T1059.004",
    "product:Splunk Enterprise",
    "product:Splunk Enterprise Security",
    "product:Splunk Cloud",
    "security_domain:endpoint"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0005",
        "name": "Defense Evasion",
        "reference": "https://attack.mitre.org/tactics/TA0005/"
      },
      "technique": [
        {
          "id": "T1059.004",
          "name": "Command and Scripting Interpreter: Unix Shell",
          "reference": "https://attack.mitre.org/techniques/T1059/004/",
          "subtechnique": []
        }
      ]
    }
  ],
  "throttle": null,
  "timeline_id": null,
  "timeline_title": null,
  "timestamp_override": null,
  "timestamp_override_fallback_disabled": false,
  "to": "now",
  "version": 1,
  "language": "eql",
  "query": "sequence by host.hostname, user.name\n  [\n    process where event.category == \"process\" and event.type == \"start\"\n     and process.name in (\"dash\", \"sudo\", \"bash\")\n     and process.command_line : \"echo 1 > /proc/sys/kernel/sysrq\"\n  ]\n",
  "type": "eql",
  "alert_suppression": {
    "duration": {
      "unit": "m",
      "value": 5
    },
    "group_by": [],
    "missing_fields_strategy": "doNotSuppress"
  },
  "data_view_id": "default",
  "event_category_override": null,
  "filters": [],
  "index": [
    "logs-endpoint.events.*"
  ],
  "tiebreaker_field": null,
  "timestamp_field": null
}