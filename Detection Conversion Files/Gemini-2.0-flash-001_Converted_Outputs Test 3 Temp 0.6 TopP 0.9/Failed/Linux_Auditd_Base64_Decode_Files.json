{
  "actions": [],
  "alias_purpose": null,
  "alias_target_id": null,
  "author": [
    "Teoderick Contreras, Splunk",
    "Google Gemini 2.0 Flash 001"
  ],
  "building_block_type": null,
  "description": "The following analytic detects suspicious Base64 decode operations that\nmay indicate malicious activity, such as data exfiltration or execution of encoded\ncommands. Base64 is commonly used to encode data for safe transmission, but attackers\nmay abuse it to conceal malicious payloads. This detection focuses on identifying\nunusual or unexpected Base64 decoding processes, particularly when associated with\ncritical files or directories. By monitoring these activities, the analytic helps\nuncover potential threats, enabling security teams to respond promptly and mitigate\nrisks associated with encoded malware or unauthorized data access.\n\nRule converted with Google Gemini 2.0 Flash 001",
  "enabled": true,
  "exceptions_list": [],
  "false_positives": [
    "Administrator or network operator can use this application for automation purposes. Please update the filter macros to remove false positives."
  ],
  "from": "now-60m",
  "interval": "10m",
  "investigation_fields": {
    "field_names": []
  },
  "license": null,
  "max_signals": 100,
  "meta": {
    "from": "now-60m",
    "interval": "10m"
  },
  "name": "Google Gemini 2.0 Flash 001 Linux Auditd Base64 Decode Files",
  "namespace": "default",
  "note": null,
  "outcome": null,
  "output_index": ".siem-signals-default",
  "references": [
    "https://www.splunk.com/en_us/blog/security/deep-dive-on-persistence-privilege-escalation-technique-and-detection-in-linux-platform.html",
    "https://gtfobins.github.io/gtfobins/dd/"
  ],
  "related_integrations": [],
  "required_fields": [
    {
      "name": "process.name",
      "type": "string"
    },
    {
      "name": "process.args",
      "type": "string"
    },
    {
      "name": "host.hostname",
      "type": "string"
    }
  ],
  "response_actions": [],
  "risk_score": 25,
  "risk_score_mapping": [],
  "rule_id": "linux_auditd_base64_decode_files",
  "rule_name_override": null,
  "setup": null,
  "severity": "medium",
  "severity_mapping": [],
  "tags": [
    "Google Gemini 2.0 Flash 001",
    "Linux Living Off The Land",
    "Linux Privilege Escalation",
    "Linux Persistence Techniques",
    "Compromised Linux Host",
    "Endpoint",
    "T1140",
    "Splunk Enterprise",
    "Splunk Enterprise Security",
    "Splunk Cloud",
    "endpoint"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0005",
        "name": "Defense Evasion",
        "reference": "https://attack.mitre.org/tactics/TA0005/"
      },
      "technique": [
        {
          "id": "T1140",
          "name": "Deobfuscate/Decode Files or Information",
          "reference": "https://attack.mitre.org/techniques/T1140/",
          "subtechnique": []
        }
      ]
    }
  ],
  "throttle": null,
  "timeline_id": null,
  "timeline_title": null,
  "timestamp_override": null,
  "timestamp_override_fallback_disabled": false,
  "to": "now",
  "version": 1,
  "language": "eql",
  "query": "sequence by host.hostname, process.pid\n  [process where event.category == \"process\" and event.type == \"start\" and process.name == \"base64\" and process.args : \"-d\"]\n  [file where event.category == \"file\" and event.type == \"creation\" and file.name != \"/dev/null\"]",
  "type": "eql",
  "alert_suppression": {},
  "data_view_id": "default",
  "event_category_override": null,
  "filters": [
    {
      "query": "event.dataset:\"auditd\"",
      "exists": false
    }
  ],
  "index": [
    "auditbeat-*",
    "filebeat-*",
    "logs-endpoint.events.*",
    "logs-system.*"
  ],
  "tiebreaker_field": null,
  "timestamp_field": null
}