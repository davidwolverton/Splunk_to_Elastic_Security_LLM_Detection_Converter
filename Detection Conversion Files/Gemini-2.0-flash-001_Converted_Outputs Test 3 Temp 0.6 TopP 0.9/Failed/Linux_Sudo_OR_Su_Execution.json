{
  "actions": [],
  "alias_purpose": null,
  "alias_target_id": null,
  "author": [
    "Google Gemini 2.0 Flash 001",
    "Teoderick Contreras, Splunk"
  ],
  "building_block_type": null,
  "description": "Google Gemini 2.0 Flash 001: The following analytic detects the execution of the \"sudo\" or \"su\" command on a Linux operating system.  It leverages data from Endpoint Detection and Response (EDR) agents, focusing on process names and parent process names. This activity is significant because \"sudo\" and \"su\" commands are commonly used by adversaries to elevate privileges, potentially leading to unauthorized access or control over the system. If confirmed malicious, this activity could allow attackers to execute commands with root privileges, leading to severe security breaches, data exfiltration, or further system compromise.",
  "enabled": true,
  "exceptions_list": [],
  "false_positives": [
    "Administrator or network operator can execute this command. Please update the filter macros to remove false positives."
  ],
  "from": "now-60m",
  "interval": "10m",
  "investigation_fields": null,
  "license": null,
  "max_signals": 100,
  "meta": {
    "version": 5,
    "data_source": [
      "Sysmon for Linux EventID 1"
    ],
    "date": "2025-02-10",
    "how_to_implement": "The detection is based on data that originates from Endpoint Detection and Response (EDR) agents. These agents are designed to provide security-related telemetry from the endpoints where the agent is installed. To implement this search, you must ingest logs that contain the process GUID, process name, and parent process. Additionally, you must ingest complete command-line executions.",
    "references": [
      "https://attack.mitre.org/techniques/T1548/003/"
    ]
  },
  "name": "Google Gemini 2.0 Flash 001: Linux Sudo OR Su Execution",
  "namespace": "default",
  "note": "Google Gemini 2.0 Flash 001: Rule converted from Splunk SPL.",
  "outcome": null,
  "output_index": ".siem-signals-default",
  "references": [],
  "related_integrations": [],
  "required_fields": [
    {
      "name": "process.name",
      "type": "string"
    },
    {
      "name": "process.parent.name",
      "type": "string"
    }
  ],
  "response_actions": [],
  "risk_score": 47,
  "risk_score_mapping": [],
  "rule_id": "4b00f134-6d6a-11ec-a90c-acde48001122",
  "rule_name_override": null,
  "setup": null,
  "severity": "low",
  "severity_mapping": [],
  "tags": [
    "Google Gemini 2.0 Flash 001",
    "Linux Privilege Escalation",
    "Linux Persistence Techniques",
    "Endpoint",
    "T1548.003"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0004",
        "name": "Privilege Escalation",
        "reference": "https://attack.mitre.org/tactics/TA0004/"
      },
      "technique": [
        {
          "id": "T1548",
          "name": "Abuse Elevation Control Mechanism",
          "reference": "https://attack.mitre.org/techniques/T1548/",
          "subtechnique": [
            {
              "id": "T1548.003",
              "name": "Sudo and Su",
              "reference": "https://attack.mitre.org/techniques/T1548/003/"
            }
          ]
        }
      ]
    }
  ],
  "throttle": null,
  "timeline_id": null,
  "timeline_title": null,
  "timestamp_override": null,
  "timestamp_override_fallback_disabled": false,
  "to": "now",
  "version": 1,
  "language": "eql",
  "query": "sequence by host.id\n  [process where process.name in (\"sudo\", \"su\")]\n  [process where process.parent.name in (\"sudo\", \"su\")]",
  "type": "eql",
  "alert_suppression": {},
  "data_view_id": "default",
  "event_category_override": null,
  "filters": [],
  "index": [
    "logs-endpoint.events.*",
    "auditbeat-*",
    "logs-system.*"
  ],
  "tiebreaker_field": null,
  "timestamp_field": null
}