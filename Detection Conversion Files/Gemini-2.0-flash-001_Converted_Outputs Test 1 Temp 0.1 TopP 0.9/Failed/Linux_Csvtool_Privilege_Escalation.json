{
  "actions": [],
  "author": [
    "Google Gemini 2.0 Flash 001",
    "Gowthamaraj Rajendran, Splunk"
  ],
  "building_block_type": "default",
  "description": "Google Gemini 2.0 Flash 001: The following analytic detects the execution of the 'csvtool' command with 'sudo' privileges, which can allow a user to run system commands as root. This detection leverages data from Endpoint Detection and Response (EDR) agents, focusing on process execution logs that include command-line details. This activity is significant because it indicates a potential privilege escalation attempt, where a user could gain unauthorized root access. If confirmed malicious, this could lead to full system compromise, allowing an attacker to execute arbitrary commands, escalate privileges, and maintain persistent access.",
  "enabled": true,
  "false_positives": [
    "False positives may be present, filter as needed."
  ],
  "from": "now-60m",
  "interval": "5m",
  "license": "Elastic License v2",
  "name": "Google Gemini 2.0 Flash 001: Linux Csvtool Privilege Escalation",
  "note": "Converted with Google Gemini 2.0 Flash 001",
  "output_index": ".siem-signals-default",
  "references": [
    "https://gtfobins.github.io/gtfobins/csvtool/"
  ],
  "risk_score": 47,
  "rule_id": "linux_csvtool_privilege_escalation",
  "severity": "high",
  "tags": [
    "Google Gemini 2.0 Flash 001",
    "Linux Privilege Escalation",
    "Linux Living Off The Land",
    "Endpoint",
    "T1548.003",
    "Splunk Enterprise",
    "Splunk Enterprise Security",
    "Splunk Cloud",
    "endpoint"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0004",
        "name": "Privilege Escalation",
        "reference": "https://attack.mitre.org/tactics/TA0004/"
      },
      "technique": [
        {
          "id": "T1548.003",
          "name": "Abuse Elevation Control Mechanism: Sudo and Sudo Caching",
          "reference": "https://attack.mitre.org/techniques/T1548/003/"
        }
      ]
    }
  ],
  "throttle": "no_actions",
  "type": "eql",
  "version": 1,
  "language": "eql",
  "query": """sequence by host.name
    [process where event.type == "start" and process.name == "sudo" and process.args in ("csvtool", "call")]
    [process where event.type == "start" and process.name == "csvtool" and process.args == "call"]""",
  "index": [
    "logs-endpoint.events.*"
  ],
  "data_view_id": "global",
  "risk_score_mapping": [],
  "severity_mapping": [],
  "exceptions_list": [],
  "false_positives_query": null,
  "filters": [],
  "machine_learning_job_id": null,
  "anomaly_threshold": null,
  "building_block_item_id": null,
  "building_block_type_id": null,
  "building_block_version": null,
  "building_block_item_index": null,
  "building_block_item_type": null,
  "building_block_item_name": null,
  "building_block_item_description": null,
  "building_block_item_author": null,
  "building_block_item_license": null,
  "building_block_item_reference": null,
  "building_block_item_risk_score": null,
  "building_block_item_severity": null,
  "building_block_item_tags": null,
  "building_block_item_threat": null,
  "building_block_item_throttle": null,
  "building_block_item_type_id": null,
  "building_block_item_version": null,
  "building_block_item_index_patterns": null,
  "building_block_item_data_view_id": null,
  "building_block_item_risk_score_mapping": null,
  "building_block_item_severity_mapping": null,
  "building_block_item_exceptions_list": null,
  "building_block_item_false_positives_query": null,
  "building_block_item_filters": null,
  "building_block_item_machine_learning_job_id": null,
  "building_block_item_anomaly_threshold": null,
  "building_block_item_building_block_item_id": null,
  "building_block_item_building_block_item_type": null,
  "building_block_item_building_block_item_version": null,
  "building_block_item_building_block_item_index_patterns": null,
  "building_block_item_building_block_item_data_view_id": null,
  "building_block_item_building_block_item_risk_score_mapping": null,
  "building_block_item_building_block_item_severity_mapping": null,
  "building_block_item_building_block_item_exceptions_list": null,
  "building_block_item_building_block_item_false_positives_query": null,
  "building_block_item_building_block_item_filters": null,
  "building_block_item_building_block_item_machine_learning_job_id": null,
  "building_block_item_building_block_item_anomaly_threshold": null,
  "building_block_item_building_block_item_building_block_item_id": null,
  "building_block_item_building_block_item_building_block_item_type": null,
  "building_block_item_building_block_item_building_block_item_version": null,
  "building_block_item_building_block_item_building_block_item_index_patterns": null,
  "building_block_item_building_block_item_building_block_item_data_view_id": null,
  "building_block_item_building_block_item_building_block_item_risk_score_mapping": null,
  "building_block_item_building_block_item_building_block_item_severity_mapping": null,
  "building_block_item_building_block_item_building_block_item_exceptions_list": null,
  "building_block_item_building_block_item_building_block_item_false_positives_query": null,
  "building_block_item_building_block_item_building_block_item_filters": null,
  "building_block_item_building_block_item_building_block_item_machine_learning_job_id": null,
  "building_block_item_building_block_item_building_block_item_anomaly_threshold": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_type": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_version": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_index_patterns": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_data_view_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_risk_score_mapping": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_severity_mapping": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_exceptions_list": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_false_positives_query": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_filters": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_machine_learning_job_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_anomaly_threshold": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_type": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_version": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_index_patterns": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_data_view_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_risk_score_mapping": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_severity_mapping": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_exceptions_list": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_false_positives_query": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_filters": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_machine_learning_job_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_anomaly_threshold": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_type": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_version": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_index_patterns": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_data_view_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_risk_score_mapping": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_severity_mapping": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_exceptions_list": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_false_positives_query": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_filters": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_machine_learning_job_id": null,
  "building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_building_block_item_anomaly_threshold": null
}