{
  "actions": [],
  "alias_purpose": "savedObjectConversion",
  "author": [
    "Google Gemini 2.0 Flash 001",
    "Gowthamaraj Rajendran, Splunk"
  ],
  "building_block_type": "default",
  "description": "Google Gemini 2.0 Flash 001: The following analytic detects the execution of the 'gawk' command with elevated privileges on a Linux system. It leverages Endpoint Detection and Response (EDR) telemetry to identify command-line executions where 'gawk' is used with 'sudo' and 'BEGIN{system' patterns. This activity is significant because it indicates a potential privilege escalation attempt, allowing a user to execute system commands as root. If confirmed malicious, this could lead to full root access, enabling the attacker to control the system, modify critical files, and maintain persistent access.",
  "enabled": true,
  "false_positives": [
    "False positives may be present, filter as needed."
  ],
  "from": "now-60m",
  "interval": "5m",
  "investigation_fields": {
    "field_names": []
  },
  "license": "Elastic License v2",
  "max_signals": 100,
  "meta": {
    "version": 7
  },
  "name": "Google Gemini 2.0 Flash 001: Linux GNU Awk Privilege Escalation",
  "namespace": "default",
  "note": "Converted with Google Gemini 2.0 Flash 001",
  "output_index": ".siem-signals-default",
  "references": [
    "https://gtfobins.github.io/gtfobins/gawk/",
    "https://www.geeksforgeeks.org/gawk-command-in-linux-with-examples/"
  ],
  "risk_score": 50,
  "rule_id": "linux_gnu_awk_privilege_escalation",
  "severity": "high",
  "tags": [
    "Google Gemini 2.0 Flash 001",
    "Linux Privilege Escalation",
    "Linux Living Off The Land",
    "Endpoint",
    "T1548.003",
    "Splunk Enterprise",
    "Splunk Enterprise Security",
    "Splunk Cloud",
    "endpoint"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0004",
        "name": "Privilege Escalation",
        "reference": "https://attack.mitre.org/tactics/TA0004/"
      },
      "technique": [
        {
          "id": "T1548",
          "name": "Abuse Elevation Control Mechanism",
          "reference": "https://attack.mitre.org/techniques/T1548/"
        },
        {
          "id": "T1548.003",
          "name": "Sudo and Sudo Caching",
          "reference": "https://attack.mitre.org/techniques/T1548/003/"
        }
      ]
    }
  ],
  "throttle": "no_actions",
  "to": "now",
  "type": "eql",
  "version": 1,
  "language": "eql",
  "query": "sequence by host.name\n  [process where event.type == \"start\" and process.name == \"gawk\" and process.args == \"sudo\" and process.args == \"BEGIN{system\"]",
  "index": [
    "logs-endpoint.events.*"
  ],
  "data_view_id": "default"
}